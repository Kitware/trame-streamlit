<html>
  <body>
    <iframe id="trame-iframe" height="600" width="600" title="Iframe Example"></iframe> 
    <script>
      // See discussion :
      // https://discuss.streamlit.io/t/code-snippet-create-components-without-any-frontend-tooling-no-react-babel-webpack-etc/13064
      function sendMessageToStreamlitClient(type, data) {
        var outData = Object.assign({
          isStreamlitMessage: true,
          type: type,
        }, data);
        window.parent.postMessage(outData, "*");
      }

      function init() {
        sendMessageToStreamlitClient("streamlit:componentReady", {apiVersion: 1});
      }

      function setFrameHeight(height) {
        sendMessageToStreamlitClient("streamlit:setFrameHeight", {height: height});
      }

      function sendDataToPython(data) {
        sendMessageToStreamlitClient("streamlit:setComponentValue", data);
      }

      const viewerIFrame = document.getElementById("trame-iframe");

      function sendDataToTrameApp(message_type, data){
        viewerIFrame.contentWindow.postMessage(
          { emit: message_type, value: data.toString() },
          "*"
        );
      }
      let messages_to_trame_keys = null;
      let messages_to_streamlit_keys = null;

      function onMessageReceived(event) {
        if (messages_to_trame_keys && messages_to_trame_keys.find((value) => value === event.data.emit) !== undefined) {
          sendDataToTrameApp(event.data.emit, event.data.value);
        }

        if (messages_to_streamlit_keys && messages_to_streamlit_keys.find((value) => value === event.data.emit) !== undefined) {
          sendDataToPython({
            value: event.data.value.toString(),
            dataType: "json",
          });
        }

        if (event.data.type === "streamlit:render") {
          viewerIFrame.src = event.data.args.trame_app_url;
          messages_to_trame_keys = event.data.args.messages_to_trame;
          messages_to_streamlit_keys = event.data.args.messages_to_streamlit;
        }
      }

      window.addEventListener("message", onMessageReceived);
      init();

      window.addEventListener("load", function() {
        window.setTimeout(function() {
          setFrameHeight(document.documentElement.clientHeight)
        }, 0);
      });

      setFrameHeight(600);
    </script>
  </body>
</html>
